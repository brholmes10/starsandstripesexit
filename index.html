<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Stars & Stripes Event Exit Plan</title>
<meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
<link href="https://api.mapbox.com/mapbox-gl-js/v3.2.0/mapbox-gl.css" rel="stylesheet">
<script src="https://api.mapbox.com/mapbox-gl-js/v3.2.0/mapbox-gl.js"></script>
<style>
body { margin: 0; padding: 0; }
#map { position: absolute; top: 0; bottom: 0; width: 100%; }
#Splash{width: 75pt; height: 75pt; position: absolute; padding: 5pt; display: flex;}

.marker {
        background-image: url('https://docs.mapbox.com/mapbox-gl-js/assets/pin.svg');
        background-size: cover;
        cursor: pointer;
    }

    @keyframes SlideLogo {
        from {
            transform: translateY(300);

        }

        to {
            transform: translateY(0px);

        }

    }

    .logo2 {
        animation: SlideLogo 1s ease-in 0s 1 normal forwards;

        transform: translateY(-150px);

    }
    h2,
h3 {
  margin: 10px;
  font-size: 18px;
}

h3 {
  font-size: 16px;
}

p {
  margin: 10px;
}

/**
* Set rules for how the map overlays
* (information box and legend) will be displayed
* on the page. */
.map-overlay {
  position: absolute;
  bottom: 0;
  right: 0;
  background: gray;
  margin-right: 20px;
  font-family: Arial, sans-serif;
  overflow: auto;
  border-radius: 3px;
  font-size: 18px;
  color: white
}

#features {
  top: 0;
  height: 100px;
  margin-top: 20px;
  width: 250px;
}

#legend {
  padding: 10px;
  box-shadow: 0 1px 2px rgba(0 0 0 0.1);
  line-height: 18px;
  height: 40px;
  margin-bottom: 40px;
  width: 100px;
}

.legend-key {
  display: inline-block;
  border-radius: 20%;
  width: 10px;
  height: 10px;
  margin-right: 5px;
}

</style>

</head>
<body>
<div id="map"></div>
<div id ='Splash'>
    <img class='logo2' src='https://hurricaneut.maps.arcgis.com/sharing/rest/content/items/2223cf1ae5a24e299ae302a704d2b8e1/data'></img>
</div>
<div class='map-overlay' id='legend'></div>
<script>
	mapboxgl.accessToken = 'pk.eyJ1IjoiYnJob2xtZXMxMCIsImEiOiJzRG9nY3JrIn0.dsqKQYo38X9n5NlIhPEsGA';
    const map = new mapboxgl.Map({
        container: 'map', // container ID
        // Choose from Mapbox's core styles, or make your own style with Mapbox Studio
        style: 'mapbox://styles/mapbox/satellite-streets-v12', // style URL
        center: [-113.37616000450339, 37.11300539737681], // starting position [lng, lat]
        zoom: 13 // starting zoom
    });

    const layers = [
        'West Exit',
        'South Exit',
    ];
    const colors = [
        'red',
        'yellow',
    ];
    // create legend
    const legend = document.getElementById('legend');

    layers.forEach((layer, i) => {
        const color = colors[i];
        const item = document.createElement('div');
        const key = document.createElement('span');
        key.className = 'legend-key';
        key.style.backgroundColor = color;

        const value = document.createElement('span');
        value.innerHTML = `${layer}`;
        item.appendChild(key);
        item.appendChild(value);
        legend.appendChild(item);
    });

    const geojson = {
    "type": "FeatureCollection",
    "features": [
        {
        "type": "Feature",
        "id": 1,
        "geometry": {
            "type": "LineString",
            "coordinates": [
            [
                -113.39424259172715,
                37.10560674242651
            ],
            [
                -113.39416936016687,
                37.105534132332295
            ],
            [
                -113.39408425287854,
                37.105469414362965
            ],
            [
                -113.39393383178084,
                37.10537786242112
            ],
            [
                -113.39381507809357,
                37.10532735043878
            ],
            [
                -113.3935736127418,
                37.10524526955979
            ],
            [
                -113.39302734631922,
                37.10508899833614
            ],
            [
                -113.39224555151058,
                37.10485853845805
            ],
            [
                -113.3899753785319,
                37.10418609520253
            ],
            [
                -113.38888680366387,
                37.10383882123936
            ],
            [
                -113.38881357210359,
                37.10381514342746
            ],
            [
                -113.38871658998552,
                37.10378830894713
            ],
            [
                -113.38860575315083,
                37.10376305278836
            ],
            [
                -113.38846918676977,
                37.103736217573115
            ],
            [
                -113.38817032356293,
                37.10368096949777
            ],
            [
                -113.38593379698322,
                37.10327686650871
            ],
            [
                -113.38375070938311,
                37.102868025598404
            ],
            [
                -113.38340632404929,
                37.10280646276966
            ],
            [
                -113.38303422928219,
                37.10276857732086
            ],
            [
                -113.38262453013898,
                37.10275437072045
            ],
            [
                -113.38216534909496,
                37.10274647824314
            ],
            [
                -113.38174179433683,
                37.10273227092212
            ],
            [
                -113.3813261573296,
                37.10271175018683
            ],
            [
                -113.38120573920284,
                37.10270379896167
            ],
            [
                -113.38108577182388,
                37.10269230353083
            ],
            [
                -113.38096641912855,
                37.10267727960125
            ],
            [
                -113.3808478442128,
                37.10265874770109
            ],
            [
                -113.3807302091096,
                37.1026367331517
            ],
            [
                -113.38061367456778,
                37.102611266033016
            ],
            [
                -113.38049839983222,
                37.102582381142454
            ],
            [
                -113.38038454242624,
                37.10255011794749
            ],
            [
                -113.3802722579364,
                37.102514520531564
            ],
            [
                -113.38016169979984,
                37.10247563753403
            ],
            [
                -113.38005301909467,
                37.102433522083615
            ],
            [
                -113.37994636433346,
                37.10238823172591
            ],
            [
                -113.37984188126032,
                37.1023398283447
            ],
            [
                -113.37973971265174,
                37.10228837807748
            ],
            [
                -113.37963999812149,
                37.102233951225095
            ],
            [
                -113.37954287392985,
                37.10217662215569
            ],
            [
                -113.37939245193385,
                37.10208506623397
            ],
            [
                -113.37923411398356,
                37.101974566917995
            ],
            [
                -113.37911536029625,
                37.101905110081695
            ],
            [
                -113.3789476107324,
                37.101807268867034
            ],
            [
                -113.37877665099217,
                37.101715151622805
            ],
            [
                -113.37860267631628,
                37.10162886354942
            ],
            [
                -113.37842588538854,
                37.10154850319021
            ],
            [
                -113.37824648010903,
                37.1014741623189
            ],
            [
                -113.3781221891986,
                37.10142191848774
            ],
            [
                -113.37799567925148,
                37.10137530430976
            ],
            [
                -113.37786720510974,
                37.10133441368475
            ],
            [
                -113.37773702557216,
                37.101299328982904
            ],
            [
                -113.37760540287285,
                37.101270120878986
            ],
            [
                -113.37747260215303,
                37.1012468482099
            ],
            [
                -113.37587338714827,
                37.100965861751426
            ],
            [
                -113.37475710284696,
                37.10077958865132
            ],
            [
                -113.37459399753068,
                37.10075711775093
            ],
            [
                -113.37443037005781,
                37.100738832902586
            ],
            [
                -113.37426632784425,
                37.10072474610969
            ],
            [
                -113.37410197857824,
                37.10071486661975
            ],
            [
                -113.37392185797447,
                37.100711481785694
            ],
            [
                -113.37374172079927,
                37.100713824246554
            ],
            [
                -113.37356174911746,
                37.10072189163479
            ],
            [
                -113.37338212482653,
                37.100735675796685
            ],
            [
                -113.37320302947292,
                37.10075516280059
            ],
            [
                -113.37302464406842,
                37.10078033295096
            ],
            [
                -113.37284714890731,
                37.100811160808306
            ],
            [
                -113.37210889723714,
                37.100965861751426
            ],
            [
                -113.37162992451083,
                37.101095304613914
            ],
            [
                -113.37115886863708,
                37.10122948383996
            ],
            [
                -113.37078083600595,
                37.10132419827606
            ],
            [
                -113.37059052576187,
                37.10136310169654
            ],
            [
                -113.37039898572311,
                37.10139541080792
            ],
            [
                -113.37020644431405,
                37.1014210870794
            ],
            [
                -113.37001313115323,
                37.10144009989032
            ],
            [
                -113.3698192767796,
                37.10145242656662
            ],
            [
                -113.3696251123775,
                37.1014580524079
            ],
            [
                -113.36943086950109,
                37.10145697070497
            ],
            [
                -113.36923677979799,
                37.10144918274784
            ],
            [
                -113.36904307473323,
                37.10143469782418
            ],
            [
                -113.36872046096862,
                37.10139365492856
            ],
            [
                -113.36844336933102,
                37.101354191108385
            ],
            [
                -113.36810096298575,
                37.10129736219684
            ],
            [
                -113.36788522718038,
                37.101265790958955
            ],
            [
                -113.36763980295318,
                37.10123264060763
            ],
            [
                -113.36750098630287,
                37.10122110977891
            ],
            [
                -113.36736183236651,
                37.10121484843613
            ],
            [
                -113.3672225411019,
                37.10121386557654
            ],
            [
                -113.36708331266408,
                37.10121816261246
            ],
            [
                -113.36694434711788,
                37.10122773336926
            ],
            [
                -113.36680584415036,
                37.10124256409419
            ],
            [
                -113.36666800278385,
                37.1012626334762
            ],
            [
                -113.36652214130555,
                37.10128490162049
            ],
            [
                -113.36637721955053,
                37.10131263474185
            ],
            [
                -113.36623344220007,
                37.10134579367121
            ],
            [
                -113.36609101231917,
                37.1013843315763
            ],
            [
                -113.36595013106972,
                37.10142819402784
            ],
            [
                -113.3658109974264,
                37.10147731907637
            ],
            [
                -113.36568855328838,
                37.101521853461804
            ],
            [
                -113.36556819947893,
                37.101571761767424
            ],
            [
                -113.36545017171971,
                37.101626946244174
            ],
            [
                -113.36533470117669,
                37.10168729880925
            ],
            [
                -113.3652220140073,
                37.10175270125778
            ],
            [
                -113.36511233091755,
                37.101823025494305
            ],
            [
                -113.36465314987355,
                37.10216083636337
            ],
            [
                -113.36451658349247,
                37.10226975704539
            ],
            [
                -113.36427115926529,
                37.1024670757052
            ],
            [
                -113.36410094558693,
                37.10259967342971
            ],
            [
                -113.36392875292002,
                37.10273700669607
            ],
            [
                -113.36376843598114,
                37.102864868898884
            ],
            [
                -113.36356259601693,
                37.10302430068758
            ],
            [
                -113.36308139636701,
                37.103409956449525
            ],
            [
                -113.36290512175545,
                37.103540678294706
            ],
            [
                -113.36284327095149,
                37.10358754045016
            ],
            [
                -113.3625185542308,
                37.10294872844671
            ],
            [
                -113.36201137709948,
                37.10184127742759
            ],
            [
                -113.36135885075856,
                37.10040822613161
            ],
            [
                -113.36034449649594,
                37.09820556671879
            ]
            ]
        },
        "properties": {
            "OBJECTID": 1,
            "Shape_Length": 4563.896938946134
        }
        }
    ]
    }

    const geojson2 = {
    "type": "FeatureCollection",
    "features": [
        {
        "type": "Feature",
        "id": 2,
        "geometry": {
            "type": "LineString",
            "coordinates": [
            [
                -113.39424259172715,
                37.10560674242651
            ],
            [
                -113.39427973432794,
                37.10564570576464
            ],
            [
                -113.39431410676877,
                37.10568625383224
            ],
            [
                -113.39434560298417,
                37.105728261504844
            ],
            [
                -113.39437412578401,
                37.10577159915407
            ],
            [
                -113.39439958715347,
                37.10581613304767
            ],
            [
                -113.39442190852459,
                37.10586172576226
            ],
            [
                -113.39444102101871,
                37.10590823660739
            ],
            [
                -113.39445686565907,
                37.105955522059666
            ],
            [
                -113.39446939355273,
                37.10600343620569
            ],
            [
                -113.39447856604149,
                37.10605183119236
            ],
            [
                -113.39448435482113,
                37.10610055768301
            ],
            [
                -113.3944867420288,
                37.10614946531836
            ],
            [
                -113.39448572029815,
                37.106198403180436
            ],
            [
                -113.39448129278199,
                37.106247220258304
            ],
            [
                -113.39447347314261,
                37.106295765914
            ],
            [
                -113.39446228550968,
                37.10634389034741
            ],
            [
                -113.39435936552755,
                37.10673534938917
            ],
            [
                -113.39417727701948,
                37.10723729749135
            ],
            [
                -113.39391206021162,
                37.10792076280342
            ],
            [
                -113.39359340532248,
                37.10876048520236
            ],
            [
                -113.39356767487777,
                37.108833092919916
            ],
            [
                -113.39355184117257,
                37.10888675901295
            ],
            [
                -113.39353204859192,
                37.10894042506795
            ],
            [
                -113.39351423589817,
                37.10901461011828
            ],
            [
                -113.39346673478255,
                37.109162980717336
            ],
            [
                -113.39336777277761,
                37.10949128886609
            ],
            [
                -113.39326881167096,
                37.10980854672393
            ],
            [
                -113.39318964224665,
                37.110010581064195
            ],
            [
                -113.3930827642874,
                37.110267858892904
            ],
            [
                -113.39295015588347,
                37.11054407555992
            ],
            [
                -113.39281556849097,
                37.11078714576609
            ],
            [
                -113.39260181257251,
                37.111165954995975
            ],
            [
                -113.39233461677607,
                37.11164419836937
            ],
            [
                -113.39220002938357,
                37.11187937280231
            ],
            [
                -113.39191106201793,
                37.11235445536617
            ],
            [
                -113.39152115455704,
                37.11297000666231
            ],
            [
                -113.39120645764504,
                37.11345928697892
            ],
            [
                -113.3910441608193,
                37.11371339612726
            ],
            [
                -113.39094321982574,
                37.11387596203736
            ],
            [
                -113.39079675760352,
                37.1141048163609
            ],
            [
                -113.39065821133558,
                37.11431630933936
            ],
            [
                -113.39048601866865,
                37.11459882437714
            ],
            [
                -113.39038705756201,
                37.11474876285384
            ],
            [
                -113.39020298916702,
                37.115040746287725
            ],
            [
                -113.39004267222816,
                37.11529642821955
            ],
            [
                -113.38977547643174,
                37.1157130931685
            ],
            [
                -113.38959536691222,
                37.11598297695169
            ],
            [
                -113.38948650906609,
                37.1161486948514
            ],
            [
                -113.38940931952867,
                37.11625759470147
            ],
            [
                -113.38935983852619,
                37.11632703837606
            ],
            [
                -113.38932235767338,
                37.11637414878252
            ],
            [
                -113.38928078408792,
                37.116417690047044
            ],
            [
                -113.38923545604355,
                37.116457307885405
            ],
            [
                -113.38918674236305,
                37.11649267993731
            ],
            [
                -113.38913503941728,
                37.11652351838934
            ],
            [
                -113.38908076790003,
                37.11654957231684
            ],
            [
                -113.38861367000342,
                37.11681471894138
            ],
            [
                -113.38795062888211,
                37.117188763148064
            ],
            [
                -113.38751915816968,
                37.11743023326242
            ],
            [
                -113.38734498561588,
                37.11752492743941
            ],
            [
                -113.38728999726894,
                37.11756240942087
            ],
            [
                -113.38723930179908,
                37.117603560027234
            ],
            [
                -113.38719328278107,
                37.11764806789691
            ],
            [
                -113.38715228840638,
                37.11769559626651
            ],
            [
                -113.38711662884883,
                37.117745785519034
            ],
            [
                -113.38708657391763,
                37.11779825590502
            ],
            [
                -113.38706235101598,
                37.11785261041597
            ],
            [
                -113.38704414342048,
                37.1179084377883
            ],
            [
                -113.38703976210036,
                37.1179604643363
            ],
            [
                -113.38704096034664,
                37.11801266128898
            ],
            [
                -113.3870477244621,
                37.118064431979576
            ],
            [
                -113.38705997712566,
                37.11811518461398
            ],
            [
                -113.38717477193752,
                37.11845765832413
            ],
            [
                -113.38725592035038,
                37.1186549348099
            ]
            ]
        },
        "properties": {
            "OBJECTID": 1,
            "Shape_Length": 2073.7311059710505
        }
        },
        {
        "type": "Feature",
        "id": 3,
        "geometry": {
            "type": "LineString",
            "coordinates": [
            [
                -113.38253141975977,
                37.123515604782554
            ],
            [
                -113.38271262342731,
                37.12300390234089
            ],
            [
                -113.38287117607497,
                37.12243801496396
            ],
            [
                -113.38302972962093,
                37.12175774132701
            ],
            [
                -113.38319583260854,
                37.120908895775734
            ],
            [
                -113.38325623442992,
                37.12044533752962
            ],
            [
                -113.38336193649445,
                37.11994565450598
            ],
            [
                -113.38338302224798,
                37.1198940453516
            ],
            [
                -113.3834065616287,
                37.119843115087626
            ],
            [
                -113.38343252037113,
                37.11979293785298
            ],
            [
                -113.38346086068798,
                37.11974358669058
            ],
            [
                -113.38349154132521,
                37.11969513344096
            ],
            [
                -113.38352451762202,
                37.1196476486377
            ],
            [
                -113.38355974157591,
                37.11960120140474
            ],
            [
                -113.38359716191255,
                37.119555859355735
            ],
            [
                -113.38363672416038,
                37.11951168849567
            ],
            [
                -113.38367837072994,
                37.119468753124686
            ],
            [
                -113.38372204099772,
                37.11942711574453
            ],
            [
                -113.38376767139437,
                37.11938683696757
            ],
            [
                -113.38381519549719,
                37.11934797542847
            ],
            [
                -113.383864544127,
                37.119310587698926
            ],
            [
                -113.38391564544854,
                37.119274728205234
            ],
            [
                -113.38396842507538,
                37.11924044914908
            ],
            [
                -113.38406335303758,
                37.119180746300565
            ],
            [
                -113.38416115590765,
                37.11912587967379
            ],
            [
                -113.38426158750818,
                37.11907598737232
            ],
            [
                -113.38436439504498,
                37.11903119497896
            ],
            [
                -113.38446931974353,
                37.11899161523964
            ],
            [
                -113.38457609750017,
                37.11895734777966
            ],
            [
                -113.38468445954702,
                37.11892847885287
            ],
            [
                -113.38479413312834,
                37.118905081124616
            ],
            [
                -113.38495963229477,
                37.11887619882966
            ],
            [
                -113.38512613790157,
                37.11885383716706
            ],
            [
                -113.38529339313861,
                37.11883803062635
            ],
            [
                -113.3854611400396,
                37.11882880358678
            ],
            [
                -113.38562911987988,
                37.11882617027967
            ],
            [
                -113.38588938337725,
                37.11883504026848
            ],
            [
                -113.38607178899063,
                37.118840090209126
            ],
            [
                -113.38617638955053,
                37.11884061447073
            ],
            [
                -113.38628088553779,
                37.118835909087935
            ],
            [
                -113.38638501565289,
                37.118825985826895
            ],
            [
                -113.38648851951119,
                37.1188108695014
            ],
            [
                -113.38659113829407,
                37.118790597910895
            ],
            [
                -113.38725592035038,
                37.1186549348099
            ],
            [
                -113.38857353147989,
                37.11838960552473
            ],
            [
                -113.38986810441563,
                37.118102748746836
            ],
            [
                -113.39133114829805,
                37.11779265868896
            ]
            ]
        },
        "properties": {
            "OBJECTID": 2,
            "Shape_Length": 1480.2536648566438
        }
        }
    ]
    }

    map.on('load', () => {
        map.addSource('line', {
            type: 'geojson',
            data: geojson
        });

        map.addSource('line2', {
            type: 'geojson',
            data: geojson2
        });

        // SOUTH ROUTE add a line layer without line-dasharray defined to fill the gaps in the dashed line
        map.addLayer({
            type: 'line',
            source: 'line',
            id: 'line-background',
            paint: {
                'line-color': 'yellow',
                'line-width': 6,
                'line-opacity': 0.4
            }
        });

        // SOUTH ROUTE add a line layer with line-dasharray set to the first value in dashArraySequence
        map.addLayer({
            type: 'line',
            source: 'line',
            id: 'line-dashed',
            paint: {
                'line-color': 'yellow',
                'line-width': 6,
                'line-dasharray': [0, 4, 3]
            }
        });

        // NORTH ROUTE add a line layer without line-dasharray defined to fill the gaps in the dashed line
        map.addLayer({
            type: 'line',
            source: 'line2',
            id: 'line-background2',
            paint: {
                'line-color': 'red',
                'line-width': 6,
                'line-opacity': 0.4
            }
        });

        // SOUTH ROUTE add a line layer with line-dasharray set to the first value in dashArraySequence
        map.addLayer({
            type: 'line',
            source: 'line2',
            id: 'line-dashed2',
            paint: {
                'line-color': 'red',
                'line-width': 6,
                'line-dasharray': [0, 4, 3]
            }
        });

        // technique based on https://jsfiddle.net/2mws8y3q/
        // an array of valid line-dasharray values, specifying the lengths of the alternating dashes and gaps that form the dash pattern
        const dashArraySequence = [
            [0, 4, 3],
            [0.5, 4, 2.5],
            [1, 4, 2],
            [1.5, 4, 1.5],
            [2, 4, 1],
            [2.5, 4, 0.5],
            [3, 4, 0],
            [0, 0.5, 3, 3.5],
            [0, 1, 3, 3],
            [0, 1.5, 3, 2.5],
            [0, 2, 3, 2],
            [0, 2.5, 3, 1.5],
            [0, 3, 3, 1],
            [0, 3.5, 3, 0.5]
        ];

        let step = 0;

        function animateDashArray(timestamp) {
            // Update line-dasharray using the next value in dashArraySequence. The
            // divisor in the expression `timestamp / 50` controls the animation speed.
            const newStep = parseInt(
                (timestamp / 50) % dashArraySequence.length
            );

            if (newStep !== step) {
                map.setPaintProperty(
                    'line-dashed',
                    'line-dasharray',
                    dashArraySequence[step]
                );
                step = newStep;
                map.setPaintProperty(
                    'line-dashed2',
                    'line-dasharray',
                    dashArraySequence[step]
                );
                step = newStep;
            }

            // Request the next frame of the animation.
            requestAnimationFrame(animateDashArray);
        }

        // start the animation
        animateDashArray(0);
    });

    
</script>

</body>
</html>
